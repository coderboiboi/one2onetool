pipeline {
    agent any
    
    stages {
        stage('Setup environment') {
            steps {
                echo 'Setup environment'   
                script {
                    // Determine whether this is a test or a staging / release build. 
                    switch (env.BRANCH_NAME) {
                        case 'release':
                            INPUT_FILE="Questions.json"                        
                            echo "This is a release env. Input file used:${INPUT_FILE}"
                            break
                        case 'staging':
                            INPUT_FILE="Questions-test.json"
                            echo "This is a staging env. Input file used:${INPUT_FILE}"
                            break
                              }
                          }
                        }
                      }
          
                
    	stage('git-checkout') {
            steps {
                echo 'Checkout from git repo'
                git branch: 'test', url: 'https://github.com/coderboiboi/one2onetool.git'
                }
            }
        stage('build') {
            steps {
                echo 'build project'
                sh '''deployment/build.sh'''
                }
            }
        stage('test') {
            steps {
                echo 'test project'
                sh '''deployment/test.sh'''
                }
            }
        stage('deploy') {
            steps {
                echo 'deploy project'
                sh '''deployment/deploy.sh'''
                }
            }

        }
    
    post {  
         success {  
             echo 'Success!'
             emailext body: '', subject: 'Deploy success!', to: 'abc@gmail.com' 
         }  
         failure {  
             emailext body: '', subject: 'Deploy failure!', to: 'abc@gmail.com'  
         }  
         unstable {  
             emailext body: '', subject: 'Deploy unstable!', to: 'abc@gmail.com'
         }  
     }  
    
}

