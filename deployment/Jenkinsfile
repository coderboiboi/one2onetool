pipeline {
    agent any
    
    stages {        
    	stage('git-checkout') {
            steps {
                echo 'Checkout from git repo'
                git branch: "${BRANCH}", url: 'https://github.com/coderboiboi/one2onetool.git'
                }
            }
        stage('test') {
            steps {
                echo 'test project'
                sh "deployment/test.sh"
                }
            }      
        stage('build') {
            steps {
                echo 'build project'
                sh "deployment/build.sh ${BRANCH}"
                }
            }
        stage('deploy') {
            steps {
                echo 'deploy project'
                sh "deployment/deploy.sh ${TAG}"
                }
            }
        }
    
    post {  
         success {  
             echo 'Success!'
             emailext body: '', subject: 'Deploy success!', to: 'abc@gmail.com' 
         }  
         failure {  
             emailext body: '', subject: 'Deploy failure!', to: 'abc@gmail.com'  
         }  
         unstable {  
             emailext body: '', subject: 'Deploy unstable!', to: 'abc@gmail.com'
         }  
     }  
    
}
